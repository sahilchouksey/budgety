const budgetController=function(){class e{constructor(e,t,n){this.id=e,this.description=t,this.value=n}}class t extends e{constructor(e,t,n,a){super(e,t,n),this.percentage=-1}calculatePerc(e){this.percentage=e>0?Math.round(this.value/e*100):-1}getPercentage(){return this.percentage}}class n extends e{constructor(e,t,n){super(e,t,n)}}const a=e=>{const t=l.allItems[e].reduce((e,t,n)=>e+t.value,0);l.totals[e]=t},l={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1};return{addItem:(e,a,c)=>{let i,r;return i=l.allItems[e].length>0?l.allItems[e][l.allItems[e].length-1].id+1:0,"exp"===e?r=new t(i,a,c):"inc"===e&&(r=new n(i,a,c)),l.allItems[e].push(r),r},deleteItem:(e,t)=>{let n,a;-1!==(a=(n=l.allItems[e].map(e=>e.id)).indexOf(t))&&l.allItems[e].splice(a,1)},calculateBudget:()=>{a("inc"),a("exp"),l.budget=l.totals.inc-l.totals.exp,l.totals.inc>0?l.percentage=Math.round(l.totals.exp/l.totals.inc*100):l.percentage=-1},calculatePercentages:()=>{l.allItems.exp.forEach(e=>e.calculatePerc(l.totals.inc))},getPercentages:()=>{return l.allItems.exp.map(e=>e.getPercentage())},getBudget:()=>({totalInc:l.totals.inc,totalExp:l.totals.exp,budget:l.budget,percentage:l.percentage}),testing:()=>{console.log(l)}}}(),UIController=function(){const e=new Map;e.set("inputType",".add__type"),e.set("inputDescription",".add__description"),e.set("inputValue",".add__value"),e.set("inputBtn",".add__btn"),e.set("incomeContainer",".income__list"),e.set("expensesContainer",".expenses__list"),e.set("budgetLabel",".budget__value"),e.set("incomeLabel",".budget__income--value"),e.set("expensesLabel",".budget__expenses--value"),e.set("percentageLabel",".budget__expenses--percentage"),e.set("container",".container"),e.set("expPercentageLabel",".item__percentage"),e.set("dateLabel",".budget__title--month");var t=(e,t)=>{var n,a;return n=(e=(e=Math.abs(e)).toFixed(2)).split("."),int=n[0],int.length>3&&(int=int.substr(0,int.length-3),int.substr(int.length-3,3)),a=n[1],`${"exp"===t?"-":"+"} ${int}.${a}`};return{getInput:()=>({type:document.querySelector(e.get("inputType")).value,description:document.querySelector(e.get("inputDescription")).value,value:parseFloat(document.querySelector(e.get("inputValue")).value)}),addListItem:(n,a)=>{let l,c,i;"inc"===a?(i=e.get("incomeContainer"),l='<div class="item clearfix" id="inc-%id%"><div class="item__description">%description%</div><div class="right clearfix"><div class="item__value">%value%</div><div class="item__delete"><button class="item__delete--btn"><i class="fal fa-minus-circle"></i></button></div></div></div>'):"exp"==a&&(i=e.get("expensesContainer"),l='<div class="item clearfix" id="exp-%id%"><div class="item__description">%description%</div><div class="right clearfix"><div class="item__value">%value%</div><div class="item__percentage">21%</div><div class="item__delete"><button class="item__delete--btn"><i class="fal fa-minus-circle"></i></button></div></div></div>'),c=(c=(c=l.replace("%id%",n.id)).replace("%description%",n.description)).replace("%value%",t(n.value,a)),document.querySelector(i).insertAdjacentHTML("beforeend",c)},deleteListItem:e=>{const t=document.getElementById(e);t.parentNode.removeChild(t)},displayBudget:n=>{let a;a=n.budget>0?"inc":"exp",document.querySelector(e.get("budgetLabel")).textContent=t(n.budget,a),document.querySelector(e.get("incomeLabel")).textContent=t(n.totalInc,"inc"),document.querySelector(e.get("expensesLabel")).textContent=t(n.totalExp,"exp"),n.percentage>0&&n.budget>0?document.querySelector(e.get("percentageLabel")).textContent=`${n.percentage}%`:document.querySelector(e.get("percentageLabel")).textContent="---"},displayPercentages:(t,n)=>{let a;const l=document.querySelectorAll(e.get("expPercentageLabel")),c=Array.from(l);if(n.budget>=0){let e=t.reduce((e,t)=>e+t,0);e>100&&(e=-1),c.forEach((e,n)=>{t[n]>0&&t[n]<=100?e.textContent=` ${t[n]}% `:e.textContent="---"})}else c.forEach((e,t)=>{a=t}),c[a].textContent="---"},clearFields:()=>{const t=document.querySelectorAll(e.get("inputDescription")+", "+e.get("inputValue")),n=Array.from(t);n.forEach(e=>e.value=""),n[0].focus()},displayMonth:function(){let t,n,a,l,c;n=(t=new Date).getFullYear(),a=t.getMonth(),c=t.getDate(),l=["January","February","March","April","May","June","July","August","September","October","November","December"],document.querySelector(e.get("dateLabel")).textContent=c+" "+l[a]+" "+n},changedType:function(){var t=document.querySelectorAll(e.get("inputType")+","+e.get("inputDescription")+","+e.get("inputValue"));Array.from(t).forEach(e=>{e.classList.toggle("red-focus")}),document.querySelector(e.get("inputBtn")).classList.toggle("red")},getDOMStrings:()=>e}}(),controller=function(e,t){let n;const a=()=>{e.calculateBudget(),n=e.getBudget(),t.displayBudget(n)},l=()=>{e.calculatePercentages();const a=e.getPercentages();t.displayPercentages(a,n)},c=()=>{let n,c;""!==(n=t.getInput()).description&&"number"!=typeof n.description&&!isNaN(n.value)&&n.value>0&&"string"==typeof n.description&&(c=e.addItem(n.type,n.description,n.value),t.addListItem(c,n.type),t.clearFields()),a(),l()},i=()=>{let n,c,i,r;(n=event.target.parentNode.parentNode.parentNode.parentNode.id)&&(i=(c=n.split("-"))[0],r=parseInt(c[1]),e.deleteItem(i,r),t.deleteListItem(n),a(),l())};return{init:()=>{console.log("ðŸ¦…"),t.displayMonth(),(()=>{const e=t.getDOMStrings();document.querySelector(e.get("inputBtn")).addEventListener("click",c),addEventListener("keypress",e=>{13!==e.keyCode&&13!==e.which||c()}),document.querySelector(e.get("container")).addEventListener("click",i),document.querySelector(e.get("inputType")).addEventListener("change",t.changedType)})(),t.displayBudget({totalInc:0,totalExp:0,budget:0,percentage:-1})}}}(budgetController,UIController);controller.init();
